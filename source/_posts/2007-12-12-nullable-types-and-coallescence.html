---
layout: post
title: "Nullable Types and the Coallescence Operator"
date: 2007-12-12
comments: true
categories:
 - .net
 - c#
---

<div class='post'>
I'm going to talk a bit about a couple of nice features introduced in <span style="font-weight:bold;">.NET 2.0</span>. It's nothing new, but it's sweet anyway.<br /><br /><span style="font-weight:bold;">Nullable Types</span><br />Nullable types address the scenario where you want to be able to have a primitive type with a null (or unknown) value. This is common in database scenarios, but is also useful in other situations. This is a PITA to deal with in .NET 1.1, and you have to do some boxing or wrapping to get along with it.<br /><br />Since .NET 2.0 we have Nullable Types, a much cleaner way to do it.<br />Nullable Types are declared either as:<br /><code>System.Nullable<T> variable</code><br />or the simpler way:<br /><code>T? variable</code><br />where  T is the underlying type of the nullable type. T can be any value type including struct; it cannot be a reference type.<br /><br />Examples of Nullable Types:<br /><code>int? i = 10;<br />double? d1 = 3.14;<br />bool? flag = null;<br />char? letter = 'a';<br />int?[] arr = new int?[10];</code><br /><br />To do a null check we could write:<br /><code>if (i.HasValue) {...}</code><br />but again we can just simplify it to:<br /><code>if (i != null) {...}</code><br /><br />Nevertheless, there are a few things to consider when dealing with nullable types:<br /><br />Exceptions:<br /><code>int? n = null;<br />//int m1 = n;      // Will not compile.<br />int m2 = (int)n;   // Compiles, but will create an exception if x is null.<br />int m3 = n.Value;  // Compiles, but will create an exception if x is null.</code><br /><br />Operators:<br /><code>int? a = 10;<br />int? b = null;<br />a++;         // Increment by 1, now a is 11.<br />a = a * 10;  // Multiply by 10, now a is 110.<br />a = a + b;   // Add b, now a is null.</code><br /><br />Comparisons: If one of the nullable types is null, the comparison evaluates to false<br /><code>int? num1 = 10;<br />int? num2 = null;<br />if (num1 >= num2)<br />{<br />    System.Console.WriteLine("num1 is greater than or equal to num1");<br />}<br />else<br />{<br />    // num1 is NOT less than num2. --> WRONG ASSUMPTION!!! <br />}</code><br /><br />The bool? nullable type can contain three different values: true, false and null. As such, the cannot be used in conditionals such as with if, for, or while. It would give a compilation error.<br /><code>bool? b = null;<br />if (b) // Error CS0266.<br />{<br />}</code><br /><br /><span style="font-weight:bold;">The ?? (Coalescence) Operator</span><br />The ?? operator defines a default value that is returned when a nullable type is assigned to a non-nullable type.<br /><code>int? c = null;<br />// d = c, unless c is null, in which case d = -1.<br />int d = c ?? -1;</code><br /><br />This operator can also be used with multiple nullable types. For example:<br /><code>int? e = null;<br />int? f = null;<br />// g = e or f, unless e and f are both null, in which case g = -1.<br />int g = e ?? f ?? -1;</code></div>
